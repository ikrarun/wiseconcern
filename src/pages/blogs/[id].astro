---
import Layout from "#/Layout.astro";
import { Image } from "astro:assets";

import { getEntry } from "astro:content";
import { slugify } from "utils/utils";

const params = Astro.params;
const url = params.id;

if (url === undefined) {
  return Astro.redirect("/404");
}

const blogPost = await getEntry("blogs", slugify(url));
if (blogPost === undefined) {
  return Astro.redirect("/blogs/404");
}
const { Content } = await blogPost.render();
---

<Layout title={blogPost.data.title}>
  <div
    class="w-full mx-auto max-w-[900px] px-8 items-center grow pt-6 flex flex-col h-fit"
  >
    <Image
      src={blogPost.data.image}
      alt={blogPost.data.title}
      inferSize
      loading={"eager"}
      class="object-cover rounded-t-xl h-52 w-full max-w-[780px] aspect-auto"
    />
    <article
      class="w-full prose-headings:my-1 my-2 prose-ul:my-1 flex flex-col max-w-[780px] prose-a:text-blue-600 prose-a:decoration-dotted prose-a:underline-offset-8 prose"
    >
      <Content />
    </article>
  </div>
</Layout>
